<!DOCTYPE html>
<html>
<head>
  <title>huxleyçš„å°ç«™</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ===== ä¸»è‰²è°ƒ ===== */
    :root {
      --primary: #2196f3;       /* Main blue color */
      --secondary: #ff4081;     /* Pink accent color */
      --accent: #4CAF50;        /* Green accent color */
      --bg-color: rgba(255, 255, 255, 0.1);  /* Semi-transparent white background */
      --text-color: #000;       /* Default text color */
      --nav-bg: rgba(0, 0, 0, 0.9); /* Navigation background */
      --panel-bg: rgba(255, 255, 255, 0.15); /* Panel background */
    }

    /* ===== BASE STYLES ===== */
    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Arial Rounded MT Bold', sans-serif;
      overflow-x: hidden;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* ===== BACKGROUND CANVAS ===== */
    #backgroundCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none; /* Prevent canvas from blocking mouse events */
    }

    /* ===== MAIN CONTENT CONTAINER ===== */
    .main-container {
      position: relative;
      width: 90%;
      max-width: 800px;
      margin: 2rem auto;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      border-radius: 30px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
      padding: 2rem;
      z-index: 2;
      transition: all 0.3s;
    }

    /* ===== ABOUT PAGE CONTAINER ===== */
    .about-container {
      display: none; /* Hidden by default */
      position: relative;
      width: 90%;
      max-width: 800px;
      margin: 2rem auto;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      border-radius: 30px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
      padding: 2rem;
      z-index: 2;
    }

    /* ===== NAVIGATION ===== */
    .nav-container {
      position: fixed;
      top: 0;
      left: -250px; /* Initially hidden off-screen */
      width: 250px;
      height: 100vh;
      background: var(--nav-bg);
      backdrop-filter: blur(15px);
      z-index: 4;
      transition: all 0.3s ease;
      overflow-y: auto; /* Enable scrolling if content exceeds height */
    }

    .nav-content {
      padding: 60px 20px 20px; /* Extra padding at top for menu button */
    }

    .nav-btn {
      display: block;
      width: 100%;
      margin: 10px 0;
      text-align: left;
      padding: 12px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      color: white;
      border: none;
      font-family: inherit;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .nav-btn:hover {
      transform: translateX(5px); /* Subtle hover effect */
    }

    /* ===== MENU TOGGLE BUTTON ===== */
    .menu-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 30px;
      height: 30px;
      cursor: pointer;
      z-index: 5;
      background: white;
      border-radius: 4px;
      padding: 8px 5px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: all 0.3s;
    }
    .menu-toggle span {
      width: 100%;
      height: 3px;
      background: black;
      transition: all 0.3s;
      display: block;
    }
    .menu-toggle.active {
      background: black;
    }
    .menu-toggle.active span {
      background: white;
    }

    /* ===== BUTTON STYLES ===== */
    .download-btn {
      display: inline-block;
      padding: 1rem 2rem;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      color: white;
      text-decoration: none;
      border-radius: 50px;
      font-weight: bold;
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
      border: none;
    }
    .download-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    /* ===== GAME CONTAINER ===== */
    .game-container {
      position: relative;
      margin: 2rem 0;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 20px;
    }

    /* ===== GAME CONTROL BUTTONS ===== */
    .game-controls-container {
      position: absolute;
      right: 20px;  /* ä»å³ä¾§å®šä½ */
      top: 20px;    /* ä¸å¾—åˆ†æ˜¾ç¤ºå¯¹é½ */
      width: auto;  /* è‡ªåŠ¨å®½åº¦ */
      z-index: 10;  /* ç¡®ä¿åœ¨ç”»å¸ƒä¸Šæ–¹ */
    }
    
    .game-bottom-controls {
      position: absolute;
      bottom: -70px;
      left: 0;
      width: 100%;
      text-align: center;
    }

    /* ===== OVERLAY STYLES ===== */
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      z-index: 3;
    }

    /* ===== PANEL STYLES ===== */
    .panel {
      position: relative;
      width: 80%;
      max-width: 600px;
      max-height: 70vh;
      margin: 5% auto;
      padding: 2rem;
      background: var(--panel-bg);
      border-radius: 20px;
      animation: panelSlide 0.5s ease-out;
      overflow-y: auto;
    }
    .panel::-webkit-scrollbar {
      width: 8px;
    }
    .panel::-webkit-scrollbar-track {
      background: rgba(0,0,0,0.2);
      border-radius: 4px;
    }
    .panel::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 4px;
    }

    /* ===== LIST ITEMS ===== */
    .list-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      margin: 1rem 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      transition: transform 0.3s;
    }
    .list-item:hover {
      transform: scale(1.02);
    }

    /* ===== FEATURE CARDS ===== */
    .feature-card {
      padding: 1.5rem;
      margin: 1rem 0;
      background: rgba(255,255,255,0.08);
      border-radius: 15px;
      border: 1px solid var(--primary);
    }
    .feature-card h3 {
      color: var(--accent);
      margin-top: 0;
    }

    /* ===== MOBILE CONTROLS ===== */
    .mobile-controls {
      display: none;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .control-btn {
      padding: 15px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 24px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .control-btn:hover {
      background: rgba(255,255,255,0.3);
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 768px) {
      .mobile-controls {
        display: grid;
      }
      .panel {
        width: 90%;
        padding: 1.5rem;
      }
      .game-controls-container {
        width: 100%;
      }
    }

    /* ===== ANIMATIONS ===== */
    @keyframes panelSlide {
      from { transform: translateY(-100px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body>
  <!-- BACKGROUND CANVAS -->
  <canvas id="backgroundCanvas"></canvas>

  <!-- NAVIGATION MENU -->
  <div class="nav-container" id="navContainer">
    <div class="nav-content">
      <button class="nav-btn" onclick="showPanel('home')">é¦–é¡µ</button>
      <button class="nav-btn" onclick="showPanel('game')">æ¸¸æˆä¸­å¿ƒ</button>
      <button class="nav-btn" onclick="showPanel('download')">ä¸‹è½½ä¸­å¿ƒ</button>
      <button class="nav-btn" onclick="showPanel('link')">å¸¸ç”¨ç½‘ç«™</button>
      <button class="nav-btn" onclick="showPanel('about')">å…³äºæˆ‘</button>
      <button class="nav-btn" onclick="showPanel('new')">ä¸ªæ€§åŒ–è®¾ç½®</button>
    </div>
  </div>

  <!-- MENU TOGGLE BUTTON -->
  <div class="menu-toggle" id="menuToggle">
    <span></span>
    <span></span>
    <span></span>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main-container" id="mainContent">
    <h1 style="color: rgb(2, 19, 88); text-align: center;">huxleyçš„å°ç«™</h1>
    <p style="text-align: center;">æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººç½‘ç«™</p>
  </div>

  <!-- ABOUT ME PAGE -->
  <div class="about-container" id="aboutContent">
    <h1 style="color: var(--primary); text-align: center;">å…³äºæˆ‘</h1>
    
    <div class="list-item">
      <div>
        <h3 style="color: var(--secondary); margin: 0 0 5px 0;">åŸºæœ¬ä¿¡æ¯</h3>
        <p style="margin: 0;">å§“å: Huxley</p>
        <p style="margin: 0;">èŒä¸š: å­¦ç”Ÿ</p>
        <p style="margin: 0;">åœ°ç‚¹: ä¸­å›½</p>
      </div>
    </div>
    
    <div class="list-item">
      <div>
        <h3 style="color: var(--secondary); margin: 0 0 5px 0;">GitHub</h3>
        <p style="margin: 0;">huxley114514</p>
        <p style="margin: 0; font-size: 0.9em; color: #aaa;">å¼€æºé¡¹ç›®è´¡çŒ®è€…</p>
      </div>
      <a href="https://github.com/huxley114514" class="download-btn" target="_blank">è®¿é—®</a>
    </div>
    
    <div class="list-item">
      <div>
        <h3 style="color: var(--secondary); margin: 0 0 5px 0;">é‚®ç®±</h3>
        <p style="margin: 0;">3772642249@qq.com</p>
        <p style="margin: 0; font-size: 0.9em; color: #aaa;">å·¥ä½œè”ç³»</p>
      </div>
      <button class="download-btn" onclick="copyEmail()">å¤åˆ¶</button>
    </div>
    
    <div class="list-item">
      <div>
        <h3 style="color: var(--secondary); margin: 0 0 5px 0;">æŠ€èƒ½</h3>
        <p style="margin: 0;">HTML</p>
        <p style="margin: 0;">Python/c++</p>
      </div>
    </div>
    
    <div class="list-item">
      <div>
        <h3 style="color: var(--secondary); margin: 0 0 5px 0;">é¡¹ç›®</h3>
        <p style="margin: 0;">ä¸ªäººç½‘ç«™ç³»ç»Ÿ</p>
        <p style="margin: 0;">æ¸¸æˆå¼€å‘æ¡†æ¶</p>
      </div>
    </div>
  </div>

  <!-- æ¸¸æˆä¸­å¿ƒé¢æ¿ -->
  <div class="overlay" id="gameOverlay">
    <div class="panel">
      <h2 style="color: white; text-align: center;">æ¸¸æˆä¸­å¿ƒ</h2>
      
      <!-- æ¸¸æˆæ§åˆ¶å®¹å™¨ï¼ˆä¸Šæ–¹ï¼‰ -->
      <div style="text-align: center; margin-bottom: 10px;">
        <button id="startBtn" class="download-btn">å¼€å§‹æ¸¸æˆ</button>
      </div>
      
      <!-- æ¸¸æˆç”»å¸ƒå®¹å™¨ -->
      <div class="game-container">
        <canvas id="gameCanvas" width="580" height="400"></canvas>
        
        <!-- æ¸¸æˆUIï¼ˆå¾—åˆ†æ˜¾ç¤ºï¼‰ -->
        <div id="gameUI" style="position: absolute; top: 20px; left: 20px;">
          <p style="color: white; margin: 0;">å¾—åˆ†: <span id="score">0</span></p>
        </div>
        
        <!-- æ‰‹æœºæ§åˆ¶æŒ‰é’®ï¼ˆä¿®å¤ç‰ˆï¼‰ -->
        <div class="mobile-controls" style="position: absolute; bottom: 20px; left: 0; right: 0; padding: 0 20px;">
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
            <div></div>
            <button class="control-btn" onclick="handleControl('up')">â†‘</button>
            <div></div>
            <button class="control-btn" onclick="handleControl('left')">â†</button>
            <div></div>
            <button class="control-btn" onclick="handleControl('right')">â†’</button>
            <div></div>
            <button class="control-btn" onclick="handleControl('down')">â†“</button>
            <div></div>
          </div>
        </div>
      </div>
      
      <!-- æ¸¸æˆé“¾æ¥ï¼ˆä¸‹æ–¹ï¼‰ -->
      <div style="text-align: center; margin-top: 20px;">
        <a href="https://huxley114514.github.io/game/game1.html" 
          class="download-btn" 
          target="_blank">
          æ¸¸ç©æ˜åœ°æ±‚å‡
        </a>
      </div>
    </div>
  </div>

  <style>
  /* æ‰‹æœºæ§åˆ¶æŒ‰é’®æ ·å¼ï¼ˆç¡®ä¿è¿™äº›æ ·å¼å­˜åœ¨ï¼‰ */
  .mobile-controls {
    display: none; /* é»˜è®¤éšè—ï¼Œåœ¨ç§»åŠ¨ç«¯æ˜¾ç¤º */
  }

  .control-btn {
    padding: 15px;
    background: rgba(255,255,255,0.2);
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 24px;
    cursor: pointer;
    transition: background 0.2s;
    width: 100%;
  }

  .control-btn:hover {
    background: rgba(255,255,255,0.3);
  }

  /* å“åº”å¼è®¾è®¡ - æ‰‹æœºç«¯æ˜¾ç¤ºæ§åˆ¶æŒ‰é’® */
  @media (max-width: 768px) {
    .mobile-controls {
      display: block !important;
    }
  }
  </style>

  <!-- DOWNLOAD CENTER PANEL -->
  <div class="overlay" id="downloadOverlay">
    <div class="panel">
      <h2 style="color: white; text-align: center;">ä¸‹è½½ä¸­å¿ƒ</h2>
      <div class="download-list">
        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">æ–‡ä»¶ç”Ÿæˆå™¨ v2.1</h3>
            <p style="color: #ccc; margin: 5px 0;">å¤§å°: 35MB (åˆ†å·å‹ç¼©) | æ›´æ–°æ—¥æœŸ: 2023-08-15</p>
            <p style="color: #ff9800; font-size: 0.9rem;">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è‡ªåŠ¨æŒ‰é¡ºåºä¸‹è½½å…¨éƒ¨åˆ†å·</p>
          </div>
          <div>
            <button id="downloadFileToolsBtn" class="download-btn">ä¸‹è½½å…¨éƒ¨åˆ†å·</button>
          </div>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">python3.7.9</h3>
            <p style="color: #ccc; margin: 5px 0;">å¤§å°: 30MB (åˆ†å·å‹ç¼©)</p>
            <p style="color: #ff9800; font-size: 0.9rem;">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è‡ªåŠ¨æŒ‰é¡ºåºä¸‹è½½å…¨éƒ¨åˆ†å·</p>
          </div>
          <div>
            <button id="downloadpyBtn" class="download-btn">ä¸‹è½½å…¨éƒ¨åˆ†å·</button>
          </div>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">VScode_win11</h3>
            <p style="color: #ccc; margin: 5px 0;">å¤§å°: 105MB (åˆ†å·å‹ç¼©)</p>
            <p style="color: #ff9800; font-size: 0.9rem;">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è‡ªåŠ¨æŒ‰é¡ºåºä¸‹è½½å…¨éƒ¨åˆ†å·</p>
          </div>
          <div>
            <button id="downloadVScodeBtn" class="download-btn">ä¸‹è½½å…¨éƒ¨åˆ†å·</button>
          </div>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">pyä»£ç  v2.1</h3>
            <p style="color: #ccc; margin: 5px 0;">å¤§å°: 91å­—èŠ‚ | æ›´æ–°æ—¥æœŸ: 2025-2-22</p>
          </div>
          <a href="./downloads/kill_py.zip" class="download-btn" download>ä¸‹è½½</a>
        </div>
      </div>
      <button class="download-btn" onclick="hidePanels()" style="margin-top: 1rem; display: block; margin-left: auto; margin-right: auto;">å…³é—­</button>
    </div>
  </div>

  <!-- LINKS PANEL -->
  <div class="overlay" id="linkOverlay">
    <div class="panel">
      <h2 style="color: white; text-align: center;">å¸¸ç”¨ç½‘ç«™</h2>

      <div class="link-list">
        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">GitHub</h3>
            <p style="color: #ccc; margin: 5px 0;">ä»£ç æ‰˜ç®¡å¹³å°</p>
          </div>
          <a href="https://github.com" class="download-btn" target="_blank">è·³è½¬</a>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">DeepSeek</h3>
            <p style="color: #ccc; margin: 5px 0;">æ™ºèƒ½æœç´¢å¼•æ“</p>
          </div>
          <a href="https://www.deepseek.com/" class="download-btn" target="_blank">è·³è½¬</a>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">4399</h3>
            <p style="color: #ccc; margin: 5px 0;">å°æ¸¸æˆå¹³å°</p>
          </div>
          <a href="https://www.4399.com/" class="download-btn" target="_blank">è·³è½¬</a>
        </div>

        <div class="list-item">
          <div>
            <h3 style="color: var(--primary); margin: 0;">winè§£å‹ç¼©</h3>
            <p style="color: #ccc; margin: 5px 0;">winè§£å‹ç¼©å®˜ç½‘</p>
          </div>
          <a href="https://wyouhua.com/winzip" class="download-btn" target="_blank">è·³è½¬</a>
        </div>

      </div>
      <button class="download-btn" onclick="hidePanels()" style="margin-top: 1rem; display: block; margin-left: auto; margin-right: auto;">å…³é—­</button>
    </div>
  </div>

  <!-- PERSONALIZATION PANEL -->
  <div class="overlay" id="newOverlay">
    <div class="panel">
      <h2 style="color: white; text-align: center;">ä¸ªæ€§åŒ–è®¾ç½®</h2>
      
      <div class="feature-card">
        <h3>ğŸ¨ ä¸»é¢˜é¢œè‰²</h3>
        <p style="color: #ccc;">é€‰æ‹©ä½ å–œæ¬¢çš„é…è‰²æ–¹æ¡ˆ</p>
        <div style="margin-top: 1rem; display: flex; gap: 10px; flex-wrap: wrap;">
          <button class="download-btn" onclick="changeTheme('default')">é»˜è®¤</button>
          <button class="download-btn" onclick="changeTheme('dark')">æš—é»‘</button>
          <button class="download-btn" onclick="changeTheme('forest')">æ£®æ—</button>
        </div>
      </div>
      
      <div class="feature-card">
        <h3>ğŸŒ“ äº®/æš—æ¨¡å¼</h3>
        <p style="color: #ccc;">åˆ‡æ¢äº®è‰²æˆ–æš—è‰²ä¸»é¢˜</p>
        <div style="margin-top: 1rem; display: flex; gap: 10px;">
          <button class="download-btn" onclick="toggleDarkMode('light')">äº®è‰²</button>
          <button class="download-btn" onclick="toggleDarkMode('dark')">æš—è‰²</button>
        </div>
      </div>
      
      <button class="download-btn" onclick="hidePanels()" style="margin-top: 1rem; display: block; margin-left: auto; margin-right: auto;">å…³é—­</button>
    </div>
  </div>

  <script>
    /* ===== BACKGROUND SYSTEM ===== */
    class BackgroundSystem {
      constructor() {
        this.canvas = document.getElementById('backgroundCanvas');
        this.ctx = this.canvas.getContext('2d');
        this.points = [];
        this.mouse = { x: -1000, y: -1000 }; // Initialize off-screen
        this.init();
        this.animate();
      }

      init() {
        this.resize();
        window.addEventListener('resize', () => this.resize());
        window.addEventListener('mousemove', (e) => {
          this.mouse.x = e.clientX;
          this.mouse.y = e.clientY;
        });

        // Create 200 particles with random positions and velocities
        for(let i = 0; i < 200; i++) {
          this.points.push({
            x: Math.random() * this.canvas.width,
            y: Math.random() * this.canvas.height,
            vx: (Math.random() - 0.5) * 0.3,
            vy: (Math.random() - 0.5) * 0.3,
            radius: Math.random() * 2 + 1
          });
        }
      }

      resize() {
        this.canvas.width = window.innerWidth;
        this.canvas.height = window.innerHeight;
      }

      animate() {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        
        // Update and draw each particle
        this.points.forEach((point, index) => {
          // Update position
          point.x += point.vx;
          point.y += point.vy;
          
          // Bounce off edges
          if(point.x < 0 || point.x > this.canvas.width) point.vx *= -1;
          if(point.y < 0 || point.y > this.canvas.height) point.vy *= -1;

          // Draw particle
          this.ctx.beginPath();
          this.ctx.arc(point.x, point.y, point.radius, 0, Math.PI * 2);
          this.ctx.fillStyle = `rgba(150, 150, 150, 0.2)`;
          this.ctx.fill();

          // Draw connections between nearby particles
          for(let j = index + 1; j < this.points.length; j++) {
            const other = this.points[j];
            const distance = Math.hypot(point.x - other.x, point.y - other.y);
            if(distance < 100) {
              this.ctx.beginPath();
              this.ctx.moveTo(point.x, point.y);
              this.ctx.lineTo(other.x, other.y);
              this.ctx.strokeStyle = `rgba(150, 150, 150, ${1 - distance/100})`;
              this.ctx.lineWidth = 0.5;
              this.ctx.stroke();
            }
          }

          // Draw connection to mouse
          const mouseDistance = Math.hypot(point.x - this.mouse.x, point.y - this.mouse.y);
          if(mouseDistance < 200) {
            this.ctx.beginPath();
            this.ctx.moveTo(point.x, point.y);
            this.ctx.lineTo(this.mouse.x, this.mouse.y);
            this.ctx.strokeStyle = `rgba(150, 150, 150, ${1 - mouseDistance/200})`;
            this.ctx.lineWidth = 0.8;
            this.ctx.stroke();
          }
        });

        requestAnimationFrame(() => this.animate());
      }
    }

    /* ===== SNAKE GAME ===== */
    const gameCanvas = document.getElementById('gameCanvas');
    const gameCtx = gameCanvas.getContext('2d');
    const GRID_SIZE = 20;
    const COLS = Math.floor(gameCanvas.width / GRID_SIZE);
    const ROWS = Math.floor(gameCanvas.height / GRID_SIZE);
    let snake = [];      // Array to store snake segments
    let food = {};       // Food object
    let direction = 'right'; // Current direction
    let nextDirection = 'right'; // Next direction (to prevent instant 180 turns)
    let score = 0;       // Player score
    let isPlaying = false; // Game state
    let gameLoopId;      // Game loop ID for cancellation

    // Initialize game state
    function initGame() {
      snake = [{x: 200, y: 200}]; // Initial snake position
      direction = 'right';
      nextDirection = 'right';
      score = 0;
      spawnFood();
      isPlaying = true;
      document.getElementById('score').textContent = score;
    }

    // Create food at random position
    function spawnFood() {
      food = {
        x: Math.floor(Math.random() * COLS) * GRID_SIZE,
        y: Math.floor(Math.random() * ROWS) * GRID_SIZE
      };
      
      // Ensure food doesn't spawn on snake
      for(let segment of snake) {
        if(food.x === segment.x && food.y === segment.y) {
          return spawnFood(); // Recursively try again
        }
      }
    }

    // Update game state
    function update() {
      if(!isPlaying) return;
      
      // Update direction
      direction = nextDirection;
      
      // Create new head based on current direction
      const head = {...snake[0]}; // Copy head
      
      switch(direction) {
        case 'up': head.y -= GRID_SIZE; break;
        case 'down': head.y += GRID_SIZE; break;
        case 'left': head.x -= GRID_SIZE; break;
        case 'right': head.x += GRID_SIZE; break;
      }

      // Check wall collision
      if(head.x < 0 || head.x >= gameCanvas.width || 
         head.y < 0 || head.y >= gameCanvas.height) {
        gameOver();
        return;
      }

      // Check self collision
      for(let segment of snake) {
        if(head.x === segment.x && head.y === segment.y) {
          gameOver();
          return;
        }
      }

      // Move snake
      snake.unshift(head);
      
      // Check food collision
      if(head.x === food.x && head.y === food.y) {
        score += 10;
        document.getElementById('score').textContent = score;
        spawnFood();
      } else {
        snake.pop(); // Remove tail if no food eaten
      }
    }

    // Render game
    function draw() {
      gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      
      // Draw food
      gameCtx.fillStyle = '#ff4081';
      gameCtx.fillRect(food.x, food.y, GRID_SIZE-2, GRID_SIZE-2);

      // Draw snake
      snake.forEach((segment, index) => {
        gameCtx.fillStyle = index === 0 ? '#4CAF50' : '#2196f3'; // Head is green, body is blue
        gameCtx.fillRect(segment.x, segment.y, GRID_SIZE-2, GRID_SIZE-2);
      });
    }

    // Main game loop
    function gameLoop() {
      update();
      draw();
      if(isPlaying) {
        // Control game speed (200ms per frame)
        gameLoopId = setTimeout(() => requestAnimationFrame(gameLoop), 200);
      }
    }

    // End game
    function gameOver() {
      isPlaying = false;
      cancelAnimationFrame(gameLoopId);
      alert(`æ¸¸æˆç»“æŸï¼å¾—åˆ†ï¼š${score}`);
    }

    /* ===== NAVIGATION CONTROL ===== */
    const navContainer = document.getElementById('navContainer');
    const menuToggle = document.getElementById('menuToggle');

    // Toggle navigation menu
    function toggleNav() {
      const isOpen = navContainer.style.left === '0px';
      navContainer.style.left = isOpen ? '-250px' : '0px';
      menuToggle.classList.toggle('active');
    }

    // Menu button click handler
    menuToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleNav();
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!navContainer.contains(e.target) && !menuToggle.contains(e.target)) {
        navContainer.style.left = '-250px';
        menuToggle.classList.remove('active');
      }
    });

    /* ===== GAME CONTROL HANDLERS ===== */
    // Keyboard controls
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'ArrowUp': if(direction !== 'down') nextDirection = 'up'; break;
        case 'ArrowDown': if(direction !== 'up') nextDirection = 'down'; break;
        case 'ArrowLeft': if(direction !== 'right') nextDirection = 'left'; break;
        case 'ArrowRight': if(direction !== 'left') nextDirection = 'right'; break;
      }
    });

    // Mobile control buttons
    function handleControl(dir) {
      if(['up','down','left','right'].includes(dir)) {
        nextDirection = dir;
      }
    }

    // Start game button
    document.getElementById('startBtn').addEventListener('click', () => {
      if(!isPlaying) {
        initGame();
        gameLoop();
      }
    });

    /* ===== PANEL CONTROL ===== */
    // Show specific panel
    function showPanel(type) {
      hidePanels();
      const mainContent = document.getElementById('mainContent');
      const aboutContent = document.getElementById('aboutContent');
      
      if(type === 'home') {
        mainContent.style.display = 'block';
        aboutContent.style.display = 'none';
      } 
      else if(type === 'about') {
        mainContent.style.display = 'none';
        aboutContent.style.display = 'block';
      }
      else {
        document.getElementById(`${type}Overlay`).style.display = 'block';
        mainContent.style.display = 'none';
        aboutContent.style.display = 'none';
      }
      
      // Close navigation menu
      navContainer.style.left = '-250px';
      menuToggle.classList.remove('active');
    }

    // Hide all panels and show main content
    function hidePanels() {
      document.querySelectorAll('.overlay').forEach(panel => {
        panel.style.display = 'none';
      });
      document.getElementById('mainContent').style.display = 'block';
      document.getElementById('aboutContent').style.display = 'none';
    }

    /* ===== THEME SYSTEM ===== */
    // Change color theme
    function changeTheme(theme) {
      const root = document.documentElement;
      switch(theme) {
        case 'dark':
          root.style.setProperty('--primary', '#673ab7');
          root.style.setProperty('--secondary', '#e91e63');
          root.style.setProperty('--accent', '#8bc34a');
          break;
        case 'forest':
          root.style.setProperty('--primary', '#4CAF50');
          root.style.setProperty('--secondary', '#8bc34a');
          root.style.setProperty('--accent', '#cddc39');
          break;
        default: // Default theme
          root.style.setProperty('--primary', '#2196f3');
          root.style.setProperty('--secondary', '#ff4081');
          root.style.setProperty('--accent', '#4CAF50');
      }
    }

    // Toggle light/dark mode
    function toggleDarkMode(mode) {
      const root = document.documentElement;
      
      if(mode === 'dark') {
        // æš—è‰²ä¸»é¢˜è®¾ç½®
        root.style.setProperty('--bg-color', 'rgba(0, 0, 0, 0.9)');
        root.style.setProperty('--text-color', '#fff');
        root.style.setProperty('--nav-bg', 'rgba(0, 0, 0, 0.95)');
        root.style.setProperty('--panel-bg', 'rgba(0, 0, 0, 0.7)');
        root.style.setProperty('--nav-text-color', '#fff');
        
        // æ›´æ–°èœå•æŒ‰é’®æ ·å¼
        document.querySelector('.menu-toggle').style.background = 'black';
        document.querySelectorAll('.menu-toggle span').forEach(span => {
          span.style.background = 'white';
        });
      } else {
        // äº®è‰²ä¸»é¢˜è®¾ç½®
        root.style.setProperty('--bg-color', 'rgba(255, 255, 255, 0.9)');
        root.style.setProperty('--text-color', '#000');
        root.style.setProperty('--nav-bg', 'rgba(255, 255, 255, 0.95)');
        root.style.setProperty('--panel-bg', 'rgba(255, 255, 255, 0.7)');
        root.style.setProperty('--nav-text-color', '#000');
        
        // æ¢å¤èœå•æŒ‰é’®æ ·å¼
        document.querySelector('.menu-toggle').style.background = 'white';
        document.querySelectorAll('.menu-toggle span').forEach(span => {
          span.style.background = 'black';
        });
      }
    }

    /* ===== UTILITY FUNCTIONS ===== */
    // Copy email to clipboard
    function copyEmail() {
      navigator.clipboard.writeText('huxley@example.com')
        .then(() => alert('é‚®ç®±å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'))
        .catch(err => console.error('å¤åˆ¶å¤±è´¥:', err));
    }

    // ä¸‹è½½æ¸…å•
    document.getElementById('downloadFileToolsBtn').addEventListener('click', function() {
      const files = [
        './downloads/file_tools/file_tools.zip.001',
        './downloads/file_tools/file_tools.zip.002'
      ];
      downloadFiles(files);
    });
    document.getElementById('downloadpyBtn').addEventListener('click', function() {
      const files = [
        './downloads/python-3.7.9-amd64/python-3.7.9-amd64.zip.001',
        './downloads/python-3.7.9-amd64/python-3.7.9-amd64.zip.002'
      ];
      downloadFiles(files);
    });
    document.getElementById('downloadVScodeBtn').addEventListener('click', function() {
      const files = [
        './downloads/VSCodeUserSetup-x64-1.98.2/VSCodeUserSetup-x64-1.98.2.zip.001',
        './downloads/VSCodeUserSetup-x64-1.98.2/VSCodeUserSetup-x64-1.98.2.zip.002',
        './downloads/VSCodeUserSetup-x64-1.98.2/VSCodeUserSetup-x64-1.98.2.zip.003',
        './downloads/VSCodeUserSetup-x64-1.98.2/VSCodeUserSetup-x64-1.98.2.zip.004',
        './downloads/VSCodeUserSetup-x64-1.98.2/VSCodeUserSetup-x64-1.98.2.zip.005'
      ];
      downloadFiles(files);
    });

    // Download files sequentially
    function downloadFiles(files) {
      function downloadNext(index) {
        if (index >= files.length) {
          alert('æ‰€æœ‰åˆ†å·ä¸‹è½½å®Œæˆï¼è¯·è§£å‹ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚');
          return;
        }
        const link = document.createElement('a');
        link.href = files[index];
        link.download = files[index].split('/').pop();
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        setTimeout(() => downloadNext(index + 1), 1000);
      }
      downloadNext(0);
    }

    /* ===== INITIALIZATION ===== */
    document.addEventListener('DOMContentLoaded', () => {
      new BackgroundSystem(); // Start background animation
    });
  </script>
</body>
</html>
